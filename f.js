=LET(clients,B2,servers,C2,voip_count,D2,monthly_visits,E2,out_of_city_visits,F2,emergency,G2,cctv_count,H2,antivirus_av,I2,printers_scanners_count,J2,branches,K2,mikrotik_units,L2,vms,M2,base_cost,IFS(AND(servers=0,clients<=6),5000000,AND(servers=0,clients<=12),8000000,AND(servers<=1,clients<=15),12000000,AND(servers<=3,clients<=40),18000000,AND(servers<=3,clients<=64),25000000,AND(servers>3,clients>64),30000000),vm_cost,IF(vms>5,(vms-5)*500000,0),antivirus_cost,IF(LOWER(antivirus_av)="yes",1000000,0),printers_scanners_cost,IF(printers_scanners_count>5,(printers_scanners_count-5)*500000,0),branch_cost,IF(AND(base_cost>=25000000,branches>2),(branches-2)*1000000,0),mikrotik_cost,IF(AND(base_cost<15000000,mikrotik_units>4),(mikrotik_units-4)*500000,0),voip_cost,IF(voip_count>0,200000+MAX(voip_count-1,0)*100000,0),cctv_cost,IF(cctv_count>16,INT(cctv_count/16)*(1000000*0.5),0),extra_visits,IF(monthly_visits>2,(monthly_visits-2)*500000,0),out_of_city_visit_cost,IF(out_of_city_visits>1,out_of_city_visits*1000000,0),emergency_cost,IF(emergency>=2,(emergency-1)*1000000,0),base_cost+vm_cost+antivirus_cost+printers_scanners_cost+branch_cost+mikrotik_cost+voip_cost+cctv_cost+extra_visits+emergency_cost+out_of_city_visit_cost)
